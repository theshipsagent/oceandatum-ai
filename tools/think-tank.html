<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Think Tank — Project Backlog | OceanDatum</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

:root {
  --accent: #64ffb4;
  --nav-h: 52px;
  --bg: #0a0a0a;
  --glass: rgba(255,255,255,0.03);
  --border: rgba(255,255,255,0.08);
  --text: rgba(255,255,255,0.88);
  --sub: rgba(255,255,255,0.45);
  --dim: rgba(255,255,255,0.25);
}

html, body { height: 100%; background: var(--bg); font-family: 'Space Grotesk', sans-serif; color: var(--text); }

/* ── Navbar ── */
.old-nav-dead {
  position: fixed; top: 0; left: 0; right: 0; height: var(--nav-h);
  background: rgba(10,10,10,0.94);
  backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
  border-bottom: 1px solid rgba(100,255,180,0.12);
  display: flex; align-items: center; gap: 1rem; padding: 0 1.5rem;
  z-index: 100;
}
.nav-brand { display: flex; align-items: center; gap: 0.5rem; text-decoration: none; flex-shrink: 0; }
.nav-brand .dot { width: 7px; height: 7px; background: var(--accent); border-radius: 50%; }
.nav-brand span { font-size: 0.82rem; font-weight: 600; color: #fff; letter-spacing: 0.02em; }
.nav-brand span em { font-style: normal; color: var(--accent); }
.nav-sep { color: var(--dim); font-size: 0.9rem; }
.nav-title { font-size: 0.82rem; font-weight: 600; color: var(--sub); letter-spacing: 0.03em; }
.nav-actions { margin-left: auto; display: flex; align-items: center; gap: 0.5rem; }
.nav-status { font-size: 0.72rem; color: var(--dim); letter-spacing: 0.03em; transition: color 0.3s; }
.nav-status.saved { color: var(--accent); }

.btn {
  font-family: 'Space Grotesk', sans-serif;
  font-size: 0.75rem; font-weight: 600; letter-spacing: 0.05em;
  text-transform: uppercase; cursor: pointer; border-radius: 5px;
  padding: 0.35rem 0.85rem; border: 1px solid; transition: all 0.2s;
  white-space: nowrap;
}
.btn-edit   { background: rgba(100,255,180,0.08); color: var(--accent); border-color: rgba(100,255,180,0.3); }
.btn-edit:hover { background: rgba(100,255,180,0.15); }
.btn-save   { background: var(--accent); color: #0a0a0a; border-color: var(--accent); display: none; }
.btn-save:hover { background: #4de8a0; }
.btn-csv    { background: rgba(255,255,255,0.05); color: var(--sub); border-color: var(--border); }
.btn-csv:hover { color: var(--text); border-color: rgba(255,255,255,0.2); }
.btn-reset  { background: rgba(255,80,80,0.08); color: rgba(255,120,120,0.7); border-color: rgba(255,80,80,0.2); }
.btn-reset:hover { background: rgba(255,80,80,0.14); color: rgba(255,150,150,0.9); }
.btn-back   { background: none; color: var(--dim); border-color: var(--border); }
.btn-back:hover { color: var(--sub); }

/* ── Main ── */
main {
  margin-top: var(--nav-h);
  padding: 1.5rem 1.5rem 3rem;
  min-height: calc(100vh - var(--nav-h));
}

.page-header { margin-bottom: 1.25rem; }
.page-header h1 { font-size: 1.1rem; font-weight: 700; letter-spacing: 0.02em; margin-bottom: 0.25rem; }
.page-header p  { font-size: 0.8rem; color: var(--sub); }

/* ── Table wrapper ── */
.tbl-scroll {
  width: 100%;
  overflow-x: auto;
  border-radius: 10px;
  border: 1px solid var(--border);
  background: var(--glass);
}

table {
  width: 100%;
  border-collapse: collapse;
  font-size: 0.82rem;
  min-width: 1100px;
}

thead th {
  background: rgba(100,255,180,0.06);
  color: rgba(100,255,180,0.85);
  font-size: 0.68rem;
  font-weight: 700;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  padding: 0.7rem 0.9rem;
  text-align: left;
  border-bottom: 1px solid rgba(100,255,180,0.15);
  white-space: nowrap;
  position: sticky; top: 0;
}

tbody tr { border-bottom: 1px solid rgba(255,255,255,0.05); transition: background 0.15s; }
tbody tr:last-child { border-bottom: none; }
tbody tr:hover { background: rgba(255,255,255,0.025); }

td {
  padding: 0.65rem 0.9rem;
  vertical-align: top;
  color: var(--text);
}

td.num  { color: var(--dim); font-size: 0.72rem; width: 36px; text-align: center; }
td.name { font-weight: 600; min-width: 210px; max-width: 240px; }
td.cat  { color: var(--sub); white-space: nowrap; }
td.desc { min-width: 280px; color: rgba(255,255,255,0.65); line-height: 1.45; }
td.rel  { min-width: 130px; }
td.notes { min-width: 140px; color: rgba(255,255,255,0.45); font-size: 0.78rem; }

/* Badges */
.badge {
  display: inline-block;
  font-size: 0.65rem; font-weight: 700; letter-spacing: 0.07em;
  text-transform: uppercase; padding: 0.18rem 0.55rem; border-radius: 20px;
  white-space: nowrap;
}
.p-high { background: rgba(100,255,180,0.12); color: #64ffb4; border: 1px solid rgba(100,255,180,0.3); }
.p-med  { background: rgba(255,193,7,0.1);   color: #ffc107; border: 1px solid rgba(255,193,7,0.25); }
.p-low  { background: rgba(255,255,255,0.05); color: rgba(255,255,255,0.35); border: 1px solid rgba(255,255,255,0.1); }
.e-quick   { background: rgba(100,200,255,0.08); color: rgba(100,200,255,0.7); border: 1px solid rgba(100,200,255,0.2); }
.e-medium  { background: rgba(180,130,255,0.08); color: rgba(180,130,255,0.75); border: 1px solid rgba(180,130,255,0.2); }
.e-complex { background: rgba(255,130,100,0.08); color: rgba(255,150,120,0.8); border: 1px solid rgba(255,130,100,0.2); }
.s-idea    { background: rgba(255,255,255,0.05); color: var(--dim); border: 1px solid var(--border); }
.s-scoping { background: rgba(255,193,7,0.1);   color: #ffc107; border: 1px solid rgba(255,193,7,0.25); }
.s-indev   { background: rgba(100,255,180,0.1); color: #64ffb4; border: 1px solid rgba(100,255,180,0.3); }
.s-live    { background: rgba(50,255,100,0.15); color: #50ff80; border: 1px solid rgba(50,255,100,0.35); }
.s-scrapped{ background: rgba(255,80,80,0.08);  color: rgba(255,120,120,0.6); border: 1px solid rgba(255,80,80,0.2); }

.rel-link { color: var(--accent); text-decoration: none; font-size: 0.75rem; }
.rel-link:hover { text-decoration: underline; }

/* ── Edit mode ── */
body.edit-mode td.editable {
  cursor: text;
  outline: none;
}
body.edit-mode td.editable:focus,
body.edit-mode td.editable:hover {
  background: rgba(100,255,180,0.05);
  outline: 1px solid rgba(100,255,180,0.3);
  border-radius: 4px;
}
body.edit-mode .badge-select {
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.15);
  border-radius: 5px;
  color: var(--text);
  font-family: 'Space Grotesk', sans-serif;
  font-size: 0.72rem;
  padding: 0.2rem 0.4rem;
  cursor: pointer;
  appearance: none;
  -webkit-appearance: none;
}
.badge-select { display: none; }
body.edit-mode .badge-select { display: inline-block; }
body.edit-mode .badge-display { display: none; }

/* ── Footer ── */
.tbl-footer { margin-top: 0.75rem; font-size: 0.72rem; color: var(--dim); display: flex; justify-content: space-between; }
</style>
<style id="sn-css">
.sn{position:fixed;top:0;left:0;right:0;z-index:2000;background:rgba(10,10,10,0.95);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);border-bottom:1px solid rgba(100,255,180,0.12);padding:0 1.5rem;height:48px;display:flex;align-items:center;justify-content:space-between;font-family:'Space Grotesk',sans-serif}
.sn a{font-size:0.82rem;color:rgba(255,255,255,0.5);text-decoration:none;white-space:nowrap;transition:color 0.2s}
.sn a:hover{color:#64ffb4}
.sn-r{display:flex;gap:1.2rem;align-items:center}
.sn-hub{padding:0.25rem 0.7rem;border:1px solid rgba(255,255,255,0.12);border-radius:5px}
.sn-hub:hover{border-color:rgba(100,255,180,0.3)}
.sn-logout{color:rgba(255,100,100,0.7)!important;padding:0.25rem 0.7rem;border:1px solid rgba(255,100,100,0.2);border-radius:5px}
.sn-logout:hover{color:#ff6464!important;border-color:rgba(255,100,100,0.4)}
@media(max-width:480px){.sn{padding:0 0.75rem;height:42px}.sn a{font-size:0.72rem}.sn-r{gap:0.6rem}}
</style>
</head>
<body>

<nav class="sn">
  <a href="../index.html">Home</a>
  <div class="sn-r">
    <a href="maritime-ai-role.html">Role Brief</a>
    <a href="../cv.html">CV</a>
    <a href="../projects-hub.html" class="sn-hub">&larr; Hub</a>
  </div>
</nav>

<main>
  <div class="page-header">
    <h1>Think Tank — Project Backlog</h1>
    <p>Candidate tools and projects under consideration. Edit inline, save to browser, export CSV anytime.</p>
  </div>

  <div class="tbl-scroll">
    <table id="backlogTable">
      <thead>
        <tr>
          <th>#</th>
          <th>Project Name</th>
          <th>Category</th>
          <th>Priority</th>
          <th>Effort</th>
          <th>Status</th>
          <th>Description</th>
          <th>Related Project</th>
          <th>Notes</th>
        </tr>
      </thead>
      <tbody id="tableBody"></tbody>
    </table>
  </div>

  <div class="tbl-footer">
    <span id="rowCount"></span>
    <span id="lastSaved"></span>
  </div>
</main>

<script>
// ── Default data ──────────────────────────────────────────────────────────────
const DEFAULTS = [
  {"id":1,"name":"PDA / Ship Agency Fee Estimator","category":"Calculator","priority":"High","effort":"Medium","status":"Idea","description":"Interactive pro-forma disbursement account builder. Input vessel type, port, services — outputs itemized PDA breakdown.","related":"","notes":"No clean public version exists. High commercial value."},
  {"id":2,"name":"Demurrage & Laytime Calculator","category":"Calculator","priority":"High","effort":"Medium","status":"Idea","description":"Input cargo qty, load/discharge rate, laycan, daily rate — outputs laytime statement with demurrage or despatch.","related":"","notes":"Fixture-ready output. Useful for chartering and ops."},
  {"id":3,"name":"Gulf Coast Terminal Directory","category":"Interactive Map","priority":"High","effort":"Complex","status":"Idea","description":"Filterable map of Gulf Coast terminals by commodity — bulk, liquid, grain, break-bulk, container. Operator, berth depth, rail access.","related":"","notes":""},
  {"id":4,"name":"USACE Waterway Tonnage Statistics Viewer","category":"Data Viz","priority":"Med","effort":"Medium","status":"Idea","description":"Annual USACE tonnage by commodity and waterway, visualized cleanly. Raw government data is ugly and hard to use.","related":"../projects/inland-waterway-platform.html","notes":""},
  {"id":5,"name":"Mississippi River Lock & Dam Reference","category":"Reference","priority":"Med","effort":"Quick","status":"Idea","description":"Chamber dimensions, mile markers, wait times, commodity flow by lock. Companion to barge fleet tool.","related":"../projects/inland-waterway-platform.html","notes":""},
  {"id":6,"name":"Barge Freight Rate Estimator","category":"Calculator","priority":"Med","effort":"Medium","status":"Idea","description":"Origin/destination, commodity, tow config → estimated freight range based on published tariff benchmarks.","related":"../projects/inland-waterway-platform.html","notes":""},
  {"id":7,"name":"Bulk Commodity Flow Guide","category":"Reference","priority":"Med","effort":"Medium","status":"Idea","description":"Where major commodities originate and terminate on the inland system — grain, coal, fertilizer, petcoke.","related":"","notes":"Origin-to-port flow maps."},
  {"id":8,"name":"Louisiana Industrial Corridor Map","category":"Interactive Map","priority":"Med","effort":"Complex","status":"Idea","description":"Broader pipeline map — adds refineries, chemical plants, grain elevators, terminals in a single layered view.","related":"../projects/construction-materials.html","notes":""},
  {"id":9,"name":"River Draft & Gauge Dashboard","category":"Live Data","priority":"Low","effort":"Quick","status":"Idea","description":"Current gauge readings at key stations — Baton Rouge, Natchez, Memphis — with draft restriction alerts.","related":"","notes":"Links to USACE gauge data API."},
  {"id":10,"name":"Cargo Loading Rate Calculator","category":"Calculator","priority":"Low","effort":"Quick","status":"Idea","description":"Tons per hour to vessel days — converts terminal loading rates into time-on-berth for fixture and scheduling.","related":"","notes":""},
  {"id":11,"name":"Jones Act Bulk Fleet Directory","category":"Reference","priority":"Low","effort":"Medium","status":"Idea","description":"US-flag vessels for domestic coastwise moves — bulk, tankers, barges. Operator, capacity, and trade route fields.","related":"","notes":""},
  {"id":12,"name":"LNG Export Terminal Tracker","category":"Reference","priority":"Low","effort":"Quick","status":"Idea","description":"Operating and under-construction US LNG export capacity — status, offtake agreements, throughput. Companion to pipeline report.","related":"../projects/plaquemines-pipeline-report.html","notes":""},
  {"id":13,"name":"Inland Waterway Vessel Class Reference","category":"Reference","priority":"Low","effort":"Quick","status":"Idea","description":"Tow dimensions, max draft by segment, lock clearances for all major vessel classes on the Miss-Ohio-Illinois system.","related":"","notes":""}
];

const PRIORITY_CLASSES = { High:'p-high', Med:'p-med', Low:'p-low' };
const EFFORT_CLASSES   = { Quick:'e-quick', Medium:'e-medium', Complex:'e-complex' };
const STATUS_CLASSES   = { Idea:'s-idea', Scoping:'s-scoping', 'In Dev':'s-indev', Live:'s-live', Scrapped:'s-scrapped' };

// ── State ─────────────────────────────────────────────────────────────────────
let data = [];

function load() {
  const stored = localStorage.getItem('od_thinktank_v1');
  data = stored ? JSON.parse(stored) : JSON.parse(JSON.stringify(DEFAULTS));
  render();
  updateFooter();
}

function save() {
  localStorage.setItem('od_thinktank_v1', JSON.stringify(data));
  const ts = new Date().toLocaleString();
  localStorage.setItem('od_thinktank_saved', ts);
  document.getElementById('lastSaved').textContent = 'Last saved: ' + ts;
  const s = document.getElementById('saveStatus');
  s.textContent = 'Saved ✓'; s.className = 'nav-status saved';
  setTimeout(() => { s.textContent = 'All changes saved'; s.className = 'nav-status'; }, 2500);
}

// ── Render ────────────────────────────────────────────────────────────────────
function badge(val, classMap) {
  const cls = classMap[val] || 's-idea';
  return `<span class="badge ${cls} badge-display">${esc(val)}</span>`;
}

function selectEl(name, val, opts, classAttr) {
  const options = opts.map(o => `<option${o===val?' selected':''}>${o}</option>`).join('');
  return `<select class="badge-select ${classAttr}" data-field="${name}">${options}</select>`;
}

function esc(s) {
  return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');
}

function render() {
  const tbody = document.getElementById('tableBody');
  tbody.innerHTML = data.map((r,i) => `
    <tr data-id="${r.id}">
      <td class="num">${i+1}</td>
      <td class="name editable" data-field="name" contenteditable="false">${esc(r.name)}</td>
      <td class="cat  editable" data-field="category" contenteditable="false">${esc(r.category)}</td>
      <td>
        ${badge(r.priority, PRIORITY_CLASSES)}
        ${selectEl('priority', r.priority, ['High','Med','Low'], '')}
      </td>
      <td>
        ${badge(r.effort, EFFORT_CLASSES)}
        ${selectEl('effort', r.effort, ['Quick','Medium','Complex'], '')}
      </td>
      <td>
        ${badge(r.status, STATUS_CLASSES)}
        ${selectEl('status', r.status, ['Idea','Scoping','In Dev','Live','Scrapped'], '')}
      </td>
      <td class="desc  editable" data-field="description" contenteditable="false">${esc(r.description)}</td>
      <td class="rel   editable" data-field="related" contenteditable="false">${
        r.related
          ? `<a href="${esc(r.related)}" class="rel-link badge-display" target="_blank">→ View</a><span class="editable-rel" style="display:none">${esc(r.related)}</span>`
          : `<span class="rel-link badge-display" style="color:var(--dim)">—</span><span class="editable-rel" style="display:none"></span>`
      }</td>
      <td class="notes editable" data-field="notes" contenteditable="false">${esc(r.notes)}</td>
    </tr>`).join('');

  // Wire up select changes
  tbody.querySelectorAll('select.badge-select').forEach(sel => {
    sel.addEventListener('change', function() {
      const row = this.closest('tr');
      const id = parseInt(row.dataset.id);
      const field = this.dataset.field;
      const item = data.find(d => d.id === id);
      if (item) {
        item[field] = this.value;
        markUnsaved();
      }
    });
  });
}

function updateFooter() {
  document.getElementById('rowCount').textContent = data.length + ' items';
  const ts = localStorage.getItem('od_thinktank_saved');
  document.getElementById('lastSaved').textContent = ts ? 'Last saved: ' + ts : 'Not yet saved';
}

// ── Edit mode ─────────────────────────────────────────────────────────────────
function enterEdit() {
  document.body.classList.add('edit-mode');
  document.getElementById('btnEdit').style.display = 'none';
  document.getElementById('btnSave').style.display = '';
  document.querySelectorAll('td.editable').forEach(td => {
    td.setAttribute('contenteditable','true');
  });
  // Show editable-rel spans, hide links
  document.querySelectorAll('.editable-rel').forEach(s => s.style.display = '');
  document.querySelectorAll('.rel-link.badge-display').forEach(s => s.style.display = 'none');
  markUnsaved();
}

function markUnsaved() {
  const s = document.getElementById('saveStatus');
  s.textContent = 'Unsaved changes'; s.className = 'nav-status';
}

function saveAll() {
  // Collect contenteditable cells
  document.querySelectorAll('#tableBody tr').forEach(row => {
    const id = parseInt(row.dataset.id);
    const item = data.find(d => d.id === id);
    if (!item) return;
    row.querySelectorAll('td.editable[contenteditable]').forEach(td => {
      const field = td.dataset.field;
      if (field && field !== 'related') item[field] = td.innerText.trim();
    });
    // Handle related (plain text URL in editable-rel span)
    const relSpan = row.querySelector('.editable-rel');
    if (relSpan) item.related = relSpan.innerText.trim();
  });

  save();
  exitEdit();
  render(); // re-render with updated links
}

function exitEdit() {
  document.body.classList.remove('edit-mode');
  document.getElementById('btnEdit').style.display = '';
  document.getElementById('btnSave').style.display = 'none';
  document.querySelectorAll('td.editable').forEach(td => td.setAttribute('contenteditable','false'));
}

// ── Export CSV ────────────────────────────────────────────────────────────────
function exportCSV() {
  const headers = ['#','Name','Category','Priority','Effort','Status','Description','Related Project','Notes'];
  const rows = data.map((r,i) => [
    i+1, r.name, r.category, r.priority, r.effort, r.status, r.description, r.related, r.notes
  ].map(v => '"' + String(v).replace(/"/g,'""') + '"').join(','));
  const csv = [headers.join(','), ...rows].join('\r\n');
  const blob = new Blob([csv], {type:'text/csv'});
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = 'oceandatum_think_tank_' + new Date().toISOString().slice(0,10) + '.csv';
  a.click();
}

// ── Reset ─────────────────────────────────────────────────────────────────────
function resetDefaults() {
  if (!confirm('Reset all rows to original defaults? This cannot be undone.')) return;
  localStorage.removeItem('od_thinktank_v1');
  localStorage.removeItem('od_thinktank_saved');
  data = JSON.parse(JSON.stringify(DEFAULTS));
  exitEdit();
  render();
  updateFooter();
  const s = document.getElementById('saveStatus');
  s.textContent = 'Reset to defaults'; s.className = 'nav-status';
}

// ── Init ──────────────────────────────────────────────────────────────────────
load();
</script>
</body>
</html>
